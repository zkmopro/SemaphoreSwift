# Semaphore Swift Package

This is a Swift package for Semaphore protocol.

## How to Import the Package

### Option 1: Using Xcode

1. Open your project in Xcode.

2. Go to **File > Add package dependencies**.

3. In _Search or Enter Package URL_, enter the URL: `https://github.com/zkmopro/SemaphoreSwift`

4. Choose the version and add the package to your project.

### Option 2: Using `Package.swift`

Add the following to your `Package.swift` dependencies:

```swift
let package = Package(
    name: "YourSwiftProject",
    // ...
    dependencies: [
        .package(url: "https://github.com/zkmopro/SemaphoreSwift") // Or change to your own URL
    ],
    // ...
    targets: [
        .target(name: "YourSwiftProject", dependencies: ["Semaphore"])
    ]
)
```

### Option 3: Using CocoaPods

1. Add the following to your `Podfile`:

```ruby
pod 'Semaphore', :git => 'https://github.com/zkmopro/SemaphoreSwift'
```

2. Run the installation command:

```bash
pod install
```

3. Import the package in your Swift code:

```swift
import Semaphore
```

## How to Use the Package

Here is an example of how to integrate and use this package

Import the package:

```swift
import Semaphore
```

### `Identity`

```swift
let privateKey = "secret".data(using: .utf8)!
// generate an identity from privateKey
let identity = Identity(privateKey: privateKey)
// get the identity commitment
identity.commitment()
// get private key
identity.privateKey()
// get secret scalar
identity.secretScalar()
// convert the type to Element to be used in Group
identity.toElement()
```

### `Group`

```swift
let group = Group(members: [
    identity.toElement(),
    identity2.toElement()
])
// get root
group.root()
// get depth (TODO: need to be tested)
// get members (TODO: need to be tested)
// index of (TODO: need to be tested)
// add member (TODO: need to be tested)
// add members (TODO: need to be tested)
// update member (TODO: need to be tested)
// remove member (TODO: need to be tested)
```

### `Proof`

```swift
let message = "message"
let scope = "scope"
// generate semaphore proof
// It will output a JSON string
// You can parse it with swift JSON parser
let proof = try generateSemaphoreProof(
    identity: identity,
    group: group,
    message: message,
    scope: scope,
    merkleTreeDepth: 16
)
// verify semaphore proof
let valid = try verifySemaphoreProof(proof: proof)
```

## How to Build the Package

This package relies on bindings generated by the Mopro CLI.
To learn how to build Mopro bindings, refer to the [Getting Started](https://zkmopro.org/docs/getting-started) section.
If you'd like to generate custom bindings for your own circuits or proving schemes, check out the guide on how to use the Mopro CLI: [Rust Setup for Android/iOS Bindings](https://zkmopro.org/docs/setup/rust-setup).

The bindings' source is from here [semaphore-bindings](https://github.com/vivianjeng/semaphore-bindings)

Then, replace the entire bindings directory with your generated files in the following location: [Sources/MoproiOSBindings](Sources/MoproiOSBindings)

Alternatively, you can run the following commands to copy your generated bindings into the correct location:

```sh
cp -r ../path/to/your/bindings/MoproiOSBindings ./Sources
```

## Community

-   X account: <a href="https://twitter.com/zkmopro"><img src="https://img.shields.io/twitter/follow/zkmopro?style=flat-square&logo=x&label=zkmopro"></a>
-   Telegram group: <a href="https://t.me/zkmopro"><img src="https://img.shields.io/badge/telegram-@zkmopro-blue.svg?style=flat-square&logo=telegram"></a>

## Acknowledgements

This work was initially sponsored by a joint grant from [PSE](https://pse.dev/) and [0xPARC](https://0xparc.org/). It is currently incubated by PSE.
